# Production Dockerfile for EphemeralML Gateway Enclave
# This Dockerfile assumes the binary is already built on the host
# and passed in the build context.

FROM busybox:1.36

# Copy the pre-built release binary from the host context
COPY ephemeral-ml-enclave /vsock-pingpong
COPY enclaves/vsock-pingpong/init.sh /init

RUN chmod +x /vsock-pingpong /init

# Production settings
ARG MODE=kms
ENV VSOCK_PINGPONG_MODE=${MODE}

ENTRYPOINT ["/init"]
